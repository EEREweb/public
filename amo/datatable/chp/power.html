<!DOCTYPE html>
<title>Combined Heat and Power (CHP) Project Profiles Database | Department of Energy</title>

<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
 
<script src="//www1.eere.energy.gov/apps/js/jquery/3.2.0/jquery.min.js"></script>
<script src="//www1.eere.energy.gov/apps/js/bootstrap/3.3.7/bootstrap.min.js"></script>
<script src="//www1.eere.energy.gov/apps/js/papaparse/4.1.2/papaparse.min.js"></script>
<script src="//www1.eere.energy.gov/apps/js/datatables/1.10.15/jquery.dataTables.min.js"></script>
<script src="//www1.eere.energy.gov/apps/js/bootstrap-multiselect/2.0/bootstrapMultiselect.src.js"></script>

<script src="//www1.eere.energy.gov/apps/js/funclib.js"></script>

<link href="power.css" rel="stylesheet" />

<base target="_blank">

<script src="//www1.eere.energy.gov/apps/js/pym.v1.min.js"></script>
<script src="//www1.eere.energy.gov/apps/js/shim.js"></script>

<div class="content">
    <div class="container">
        <div class="row">
			<form id="multiSelectGroup">
            <div class="col-sm-3">
                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">State</a>
                            </h3>
                        </div>
                        <div id="state_div" class="panel-collapse collapse in">
                            <div class="panel-body">
								<div id="state_div">
									<select id="state_select" name="state_select" multiple="multiple">
										<option value="AL">Alabama</option>
										<option value="AK">Alaska</option>
										<option value="AZ">Arizona</option>
										<option value="AR">Arkansas</option>
										<option value="CA">California</option>
										<option value="CO">Colorado</option>
										<option value="CT">Connecticut</option>
										<option value="DE">Delaware</option>
										<option value="DC">District Of Columbia</option>
										<option value="FL">Florida</option>
										<option value="GA">Georgia</option>
										<option value="HI">Hawaii</option>
										<option value="ID">Idaho</option>
										<option value="IL">Illinois</option>
										<option value="IN">Indiana</option>
										<option value="IA">Iowa</option>
										<option value="KS">Kansas</option>
										<option value="KY">Kentucky</option>
										<option value="LA">Louisiana</option>
										<option value="ME">Maine</option>
										<option value="MD">Maryland</option>
										<option value="MA">Massachusetts</option>
										<option value="MI">Michigan</option>
										<option value="MN">Minnesota</option>
										<option value="MS">Mississippi</option>
										<option value="MO">Missouri</option>
										<option value="MT">Montana</option>
										<option value="NE">Nebraska</option>
										<option value="NV">Nevada</option>
										<option value="NH">New Hampshire</option>
										<option value="NJ">New Jersey</option>
										<option value="NM">New Mexico</option>
										<option value="NY">New York</option>
										<option value="NC">North Carolina</option>
										<option value="ND">North Dakota</option>
										<option value="OH">Ohio</option>
										<option value="OK">Oklahoma</option>
										<option value="OR">Oregon</option>
										<option value="PA">Pennsylvania</option>
										<option value="PR">Puerto Rico</option>
										<option value="RI">Rhode Island</option>
										<option value="SC">South Carolina</option>
										<option value="SD">South Dakota</option>
										<option value="TN">Tennessee</option>
										<option value="TX">Texas</option>
										<option value="UT">Utah</option>
										<option value="VT">Vermont</option>
										<option value="VA">Virginia</option>
										<option value="WA">Washington</option>
										<option value="WV">West Virginia</option>
										<option value="WI">Wisconsin</option>
										<option value="WY">Wyoming</option>
									</select>
								</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">CHP Technical Assistance Partnerships (TAPs)</a>
                            </h3>
                        </div>
                        <div id="program_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="chptap_div">
                                    <select id="chptap_select" name="chptap_select" multiple="multiple">
										<option value="Central">Central</option>
										<option value="New England">New England</option>
										<option value="New York-New Jersey">New York-New Jersey</option>
										<option value="Mid-Atlantic">Mid-Atlantic</option>
										<option value="Midwest">Midwest</option>
										<option value="Northwest">Northwest</option>
										<option value="Southeast">Southeast</option>
										<option value="Southcentral">Southcentral</option>
										<option value="Upper-West">Upper-West</option>
										<option value="Western">Western</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">Market Sector</a>
                            </h3>
                        </div>
                        <div id="award_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="market_div">
                                    <select id="market_select" name="market_select" multiple="multiple">
										<option value="Agriculture">Agriculture</option>
										<option value="Amusement and Recreation">Amusement and Recreation</option>
										<option value="Breweries">Breweries</option>
										<option value="Data Centers">Data Centers</option>
										<option value="District Energy">District Energy</option>
										<option value="Ethanol Plants">Ethanol Plants</option>
										<option value="Food Processing">Food Processing</option>
										<option value="Forest Products">Forest Products</option>
										<option value="Healthcare">Healthcare</option>
										<option value="Hotels">Hotels</option>
										<option value="Laboratories">Laboratories</option>
										<option value="Manufacturing">Manufacturing</option>
										<option value="Metals">Metals</option>
										<option value="Military Facilities">Military Facilities</option>
										<option value="Multi-family Housing">Multi-family Housing</option>
										<option value="Natural Gas Production and Processing">Natural Gas Production and Processing</option>
										<option value="Office Buildings and Skyscrapers">Office Buildings and Skyscrapers</option>
										<option value="Pipelines">Pipelines</option>
										<option value="Public Safety">Public Safety</option>
										<option value="Pulp and Paper">Pulp and Paper</option>
										<option value="Refineries">Refineries</option>
										<option value="Retail Sales">Retail Sales</option>
										<option value="Schools">Schools</option>
										<option value="Transportation">Transportation</option>
										<option value="Universities and Colleges">Universities and Colleges</option>
										<option value="Utilities">Utilities</option>
										<option value="Waste and Wastewater Treatment">Waste and Wastewater Treatment</option>
										<option value="Wineries">Wineries</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">NAICS Code</a>
                            </h3>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="NAICS_div">
									<select id="NAICS_select" name="NAICS_select" multiple="multiple">
										<option value="111219">111219 Other Vegetable (except Potato) and Melon Farming</option>
										<option value="112112 Cattle Feedlots">112112 Cattle Feedlots</option>
										<option value="112120 Dairy Cattle and Milk Production">112120 Dairy Cattle and Milk Production</option>
										<option value="211130 Natural Gas Extraction">211130 Natural Gas Extraction</option>
										<option value="221112 Fossil Fuel Electric Power Generation">221112 Fossil Fuel Electric Power Generation</option>
										<option value="221210 Natural Gas Distribution">221210 Natural Gas Distribution</option>
										<option value="221310 Water Supply and Irrigation Systems">221310 Water Supply and Irrigation Systems</option>
										<option value="221320 Sewage Treatment Facilities">221320 Sewage Treatment Facilities</option>
										<option value="311221 Wet Corn Milling">311221 Wet Corn Milling</option>
										<option value="311224 Soybean and Other Oilseed Processing">311224 Soybean and Other Oilseed Processing</option>
										<option value="311421 Fruit and Vegetable Canning">311421 Fruit and Vegetable Canning</option>
										<option value="311511 Fluid Milk Manufacturing">311511 Fluid Milk Manufacturing</option>
										<option value="311615 Poultry Processing">311615 Poultry Processing</option>
										<option value="311919 Other Snack Food Manufacturing">311919 Other Snack Food Manufacturing</option>
										<option value="311920 Coffee and Tea Manufacturing">311920 Coffee and Tea Manufacturing</option>
										<option value="311999 Other Miscellaneous Food Manufacturing">311999 Other Miscellaneous Food Manufacturing</option>
										<option value="312111 Soft Drink Manufacturing">312111 Soft Drink Manufacturing</option>
										<option value="312120 Breweries">312120 Breweries</option>
										<option value="312130 Wineries">312130 Wineries</option>
										<option value="314110 Carpet and Rug Mills">314110 Carpet and Rug Mills</option>
										<option value="321113 Sawmills">321113 Sawmills</option>
										<option value="321918 Other Millwork">321918 Other Millwork</option>
										<option value="321999 Other Miscellaneous Wood Product Manufacturing">321999 Other Miscellaneous Wood Product Manufacturing</option>
										<option value="322110 Pulp Mills">322110 Pulp Mills</option>
										<option value="322121 Paper Mills">322121 Paper Mills</option>
										<option value="322291 Sanitary Paper Product Manufacturing">322291 Sanitary Paper Product Manufacturing</option>
										<option value="324110 Petroleum Refineries">324110 Petroleum Refineries</option>
										<option value="324199 Other Petroleum and Coal Products Manufacturing">324199 Other Petroleum and Coal Products Manufacturing</option>
										<option value="325180 Other Basic Inorganic Chemical Manufacturing">325180 Other Basic Inorganic Chemical Manufacturing</option>
										<option value="325193 Ethyl Alcohol Manufacturing">325193 Ethyl Alcohol Manufacturing</option><option value="325211 Plastics Material and Resin Manufacturing">325211 Plastics Material and Resin Manufacturing</option>
										<option value="325311 Nitrogenous Fertilizer Manufacturing">325311 Nitrogenous Fertilizer Manufacturing</option>
										<option value="325411 Medicinal and Botanical Manufacturing">325411 Medicinal and Botanical Manufacturing</option>
										<option value="325612 Polish and Other Sanitation Good Manufacturing">325612 Polish and Other Sanitation Good Manufacturing</option>
										<option value="325998 Other Miscellaneous Chemical Product and Preparation Manufacturing">325998 Other Miscellaneous Chemical Product and Preparation Manufacturing</option>
										<option value="326199 All Other Plastics Product Manufacturing">326199 All Other Plastics Product Manufacturing</option>
										<option value="331110 Iron and Steel Mills">331110 Iron and Steel Mills</option>
										<option value="331411 Primary Smelting and Refining of Copper">331411 Primary Smelting and Refining of Copper</option>
										<option value="332216 Saw Blade and Handtool Manufacturing">332216 Saw Blade and Handtool Manufacturing</option>
										<option value="333120 Construction Machinery Manufacturing">333120 Construction Machinery Manufacturing</option>
										<option value="336111 Automotive Manufacturing">336111 Automotive Manufacturing</option>
										<option value="424480 Fresh Fruit and Vegetable Merchant Wholesalers">424480 Fresh Fruit and Vegetable Merchant Wholesalers</option>
										<option value="441110 New Car Dealers">441110 New Car Dealers</option>
										<option value="445110 Supermarkets and Other Grocery Stores">445110 Supermarkets and Other Grocery Stores</option>
										<option value="488111 Air Traffic Control">488111 Air Traffic Control</option>
										<option value="488999">488999 Liquefied Natural Gas (LNG) Plants</option>
										<option value="518210 Data Processing, Hosting and Related Services">518210 Data Processing, Hosting and Related Services</option>
										<option value="522130 Credit Unions">522130 Credit Unions</option>
										<option value="531110 Rental Housing">531110 Rental Housing</option>
										<option value="531312 Nonresidential Property Managers">531312 Nonresidential Property Managers</option>
										<option value="541715 Research and Development in the Physical, Engineering, and Life Sciences">541715 Research and Development in the Physical, Engineering, and Life Sciences</option>
										<option value="562212 Solid Waste Landfills">562212 Solid Waste Landfills</option>
										<option value="562213 Solid Waste Combustors and Incinerators">562213 Solid Waste Combustors and Incinerators</option>
										<option value="562219 Other Non-hazardous Waste Treatment and Disposal">562219 Other Non-hazardous Waste Treatment and Disposal</option>
										<option value="611110 Elementary and Secondary Schools">611110 Elementary and Secondary Schools</option>
										<option value="611310 Colleges, Universities and Professional Schools">611310 Colleges, Universities and Professional Schools</option>
										<option value="622110 General Medical and Surgical Hospitals">622110 General Medical and Surgical Hospitals</option>
										<option value="621111 Offices of Physicians">621111 Offices of Physicians</option>
										<option value="623110 Nursing Care Facilities">623110 Nursing Care Facilities</option>
										<option value="623311 Continuing Care Retirement Communities">623311 Continuing Care Retirement Communities</option>
										<option value="713940 Fitness and Recreational Sports Centers">713940 Fitness and Recreational Sports Centers</option>
										<option value="721110 Hotels and Motels">721110 Hotels and Motels</option>
										<option value="721120 Casino Hotels">721120 Casino Hotels</option>
										<option value="722511 Full-Service Restaurants">722511 Full-Service Restaurants</option>
										<option value="813110 Religious Organizations">813110 Religious Organizations</option>
										<option value="813410 Civic and Social Organizations">813410 Civic and Social Organizations</option>
										<option value="813990 Cooperative Owners' Associations">813990 Cooperative Owners' Associations</option>
										<option value="921110">921110 Executive Offices (Public Administration)</option>
										<option value="922140 Correctional Institutions">922140 Correctional Institutions</option>
										<option value="927110 Space Flight Operations, Government">927110 Space Flight Operations, Government</option>
										<option value="928110 National Security">928110 National Security</option>
									</select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
			<div class="col-sm-1">&nbsp;</div>
			
            <div class="col-sm-3">

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">Technology/Prime Mover</a>
                            </h3>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="tech_div">
									<select id="tech_select" name="tech_select" multiple="multiple">
										<option value="Combined Cycle Gas Turbine">Combined Cycle Gas Turbine</option><option value="Combustion Turbine">Combustion Turbine</option><option value="Fuel Cell">Fuel Cell</option><option value="Microturbine">Microturbine</option><option value="Organic Rankine Cycle">Organic Rankine Cycle</option><option value="Reciprocating Engine">Reciprocating Engine</option><option value="Renewables Integrated with CHP">Renewables Integrated with CHP</option><option value="Steam Turbine">Steam Turbine</option>
									</select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">Fuel</a>
                            </h3>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="fuel_div">
									<select id="fuel_select" name="fuel_select" multiple="multiple">
										<option value="Biogas">Biogas</option>
										<option value="Biomass">Biomass</option>
										<option value="Coal">Coal</option>
										<option value="Compressed Natural Gas">Compressed Natural Gas (CNG)</option>
										<option value="Fuel Oil">Fuel Oil</option>
										<option value="Geothermal Energy">Geothermal Energy</option>
										<option value="Hydrogen">Hydrogen</option>
										<option value="Municipal Solid Waste">Municipal Solid Waste</option>
										<option value="Natural Gas">Natural Gas</option>
										<option value="Propane">Propane</option>
										<option value="Waste Heat">Waste Heat</option>
									</select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading" style="display: none;">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">Thermal Energy Use</a>
                            </h3>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="thermal_div">
									<select id="thermal_select" name="thermal_select" multiple="multiple">
										<option value="Anaerobic Digester">Anaerobic Digester</option><option value="Dehumidification">Dehumidification</option><option value="Electricity">Electricity</option><option value="None">None</option><option value="Process Cooling">Process Cooling</option><option value="Process Heat">Process Heat</option><option value="Space Cooling">Space Cooling</option><option value="Space Heating">Space Heating</option><option value="Steam">Steam</option><option value="Water Heating">Water Heating</option>
									</select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

			</div>
			<div class="col-sm-1">&nbsp;</div>

            <div class="col-sm-3">

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">System Size</a>
                            </h3>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="sysmin_div">
								<table><tr>
									<td class="range">Minimum:</td>
									<td><select id="sysmin_select" name="sysmin_select">
										<option value="0">0 kW</option>
										<option value="100">100 kW</option>
										<option value="500">500 kW</option>
										<option value="1000">1000 kW</option>
										<option value="5000">5000 kW</option>
										<option value="10000">10000 kW</option>
										<option value="100000">100000 kW</option>
										<option value="500000">500000 kW</option>
									</select></td>
								</tr></table>
                                </div>
                            </div>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="sysmax_div">
								<table><tr>
									<td class="range">Maximum:</td>
									<td><select id="sysmax_select" name="sysmax_select">
										<option value="100">100 kW</option>
										<option value="500">500 kW</option>
										<option value="1000">1000 kW</option>
										<option value="5000">5000 kW</option>
										<option value="10000">10000 kW</option>
										<option value="100000">100000 kW</option>
										<option value="500000">500000 kW</option>
										<option value="Infinity" selected>No Upper Limit</option>
									</select></td>
								</tr></table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="panel-group">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">
                                <a data-toggle="collapse">Year Installed</a>
                            </h3>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="yearmin_div">
								<table><tr>
									<td class="range">From: </td>
									<td><select id="yearmin_select" name="yearmin_select">
										<option value="1914" selected>1914</option>
										<option value="1915">1915</option> <option value="1916">1916</option> <option value="1917">1917</option> <option value="1918">1918</option> <option value="1919">1919</option> <option value="1920">1920</option> <option value="1921">1921</option> <option value="1922">1922</option> <option value="1923">1923</option> <option value="1924">1924</option> <option value="1925">1925</option> <option value="1926">1926</option> <option value="1927">1927</option> <option value="1928">1928</option> <option value="1929">1929</option> <option value="1930">1930</option> <option value="1931">1931</option> <option value="1932">1932</option> <option value="1933">1933</option> <option value="1934">1934</option> <option value="1935">1935</option> <option value="1936">1936</option> <option value="1937">1937</option> <option value="1938">1938</option> <option value="1939">1939</option> <option value="1940">1940</option> <option value="1941">1941</option> <option value="1942">1942</option> <option value="1943">1943</option> <option value="1944">1944</option> <option value="1945">1945</option> <option value="1946">1946</option> <option value="1947">1947</option> <option value="1948">1948</option> <option value="1949">1949</option> <option value="1950">1950</option> <option value="1951">1951</option> <option value="1952">1952</option> <option value="1953">1953</option> <option value="1954">1954</option> <option value="1955">1955</option> <option value="1956">1956</option> <option value="1957">1957</option> <option value="1958">1958</option> <option value="1959">1959</option> <option value="1960">1960</option> <option value="1961">1961</option> <option value="1962">1962</option> <option value="1963">1963</option> <option value="1964">1964</option> <option value="1965">1965</option> <option value="1966">1966</option> <option value="1967">1967</option> <option value="1968">1968</option> <option value="1969">1969</option> <option value="1970">1970</option> <option value="1971">1971</option> <option value="1972">1972</option> <option value="1973">1973</option> <option value="1974">1974</option> <option value="1975">1975</option> <option value="1976">1976</option> <option value="1977">1977</option> <option value="1978">1978</option> <option value="1979">1979</option> <option value="1980">1980</option> <option value="1981">1981</option> <option value="1982">1982</option> <option value="1983">1983</option> <option value="1984">1984</option> <option value="1985">1985</option> <option value="1986">1986</option> <option value="1987">1987</option> <option value="1988">1988</option> <option value="1989">1989</option> <option value="1990">1990</option> <option value="1991">1991</option> <option value="1992">1992</option> <option value="1993">1993</option> <option value="1994">1994</option> <option value="1995">1995</option> <option value="1996">1996</option> <option value="1997">1997</option> <option value="1998">1998</option> <option value="1999">1999</option> <option value="2000">2000</option> <option value="2001">2001</option> <option value="2002">2002</option> <option value="2003">2003</option> <option value="2004">2004</option> <option value="2005">2005</option> <option value="2006">2006</option> <option value="2007">2007</option> <option value="2008">2008</option> <option value="2009">2009</option> <option value="2010">2010</option> <option value="2011">2011</option> <option value="2012">2012</option> <option value="2013">2013</option> <option value="2014">2014</option> <option value="2015">2015</option> <option value="2016">2016</option> <option value="2017">2017</option> <option value="2018">2018</option> <option value="2019">2019</option> <option value="2020">2020</option>
									</select></td>
								</tr></table>
                                </div>
                            </div>
                        </div>
                        <div id="status_collapse" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <div id="yearmax_div">
								<table><tr>
									<td class="range">To: </td>
									<td><select id="yearmax_select" name="yearmax_select">
										<option value="1914">1914</option> <option value="1915">1915</option> <option value="1916">1916</option> <option value="1917">1917</option> <option value="1918">1918</option> <option value="1919">1919</option> <option value="1920">1920</option> <option value="1921">1921</option> <option value="1922">1922</option> <option value="1923">1923</option> <option value="1924">1924</option> <option value="1925">1925</option> <option value="1926">1926</option> <option value="1927">1927</option> <option value="1928">1928</option> <option value="1929">1929</option> <option value="1930">1930</option> <option value="1931">1931</option> <option value="1932">1932</option> <option value="1933">1933</option> <option value="1934">1934</option> <option value="1935">1935</option> <option value="1936">1936</option> <option value="1937">1937</option> <option value="1938">1938</option> <option value="1939">1939</option> <option value="1940">1940</option> <option value="1941">1941</option> <option value="1942">1942</option> <option value="1943">1943</option> <option value="1944">1944</option> <option value="1945">1945</option> <option value="1946">1946</option> <option value="1947">1947</option> <option value="1948">1948</option> <option value="1949">1949</option> <option value="1950">1950</option> <option value="1951">1951</option> <option value="1952">1952</option> <option value="1953">1953</option> <option value="1954">1954</option> <option value="1955">1955</option> <option value="1956">1956</option> <option value="1957">1957</option> <option value="1958">1958</option> <option value="1959">1959</option> <option value="1960">1960</option> <option value="1961">1961</option> <option value="1962">1962</option> <option value="1963">1963</option> <option value="1964">1964</option> <option value="1965">1965</option> <option value="1966">1966</option> <option value="1967">1967</option> <option value="1968">1968</option> <option value="1969">1969</option> <option value="1970">1970</option> <option value="1971">1971</option> <option value="1972">1972</option> <option value="1973">1973</option> <option value="1974">1974</option> <option value="1975">1975</option> <option value="1976">1976</option> <option value="1977">1977</option> <option value="1978">1978</option> <option value="1979">1979</option> <option value="1980">1980</option> <option value="1981">1981</option> <option value="1982">1982</option> <option value="1983">1983</option> <option value="1984">1984</option> <option value="1985">1985</option> <option value="1986">1986</option> <option value="1987">1987</option> <option value="1988">1988</option> <option value="1989">1989</option> <option value="1990">1990</option> <option value="1991">1991</option> <option value="1992">1992</option> <option value="1993">1993</option> <option value="1994">1994</option> <option value="1995">1995</option> <option value="1996">1996</option> <option value="1997">1997</option> <option value="1998">1998</option> <option value="1999">1999</option> <option value="2000">2000</option> <option value="2001">2001</option> <option value="2002">2002</option> <option value="2003">2003</option> <option value="2004">2004</option> <option value="2005">2005</option> <option value="2006">2006</option> <option value="2007">2007</option> <option value="2008">2008</option> <option value="2009">2009</option> <option value="2010">2010</option> <option value="2011">2011</option> <option value="2012">2012</option> <option value="2013">2013</option> <option value="2014">2014</option> <option value="2015">2015</option> <option value="2016">2016</option> <option value="2017">2017</option> <option value="2018">2018</option> <option value="2019">2019</option> <option value="2020">2020</option>
										<option value="2021" selected>2021</option>
									</select></td>
									</tr></table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

				<div class="panel-group panel-default">
                    <div id="reset_collapse" class="panel-collapse collapse in">
                        <button id="btnReset" type="button" class="btn btn-default">Reset</button>
                    </div>
                </div>
			
            </div>
			</form>

            <div class="col-sm-12" id="dt_container">
                <table id="projects-datatable" class="display dataTable"></table>
            </div>
        </div>
    </div>
</div>

<script>

    $(document).ready(function () {

        //setup Column locations
        var objColumn = {
            "CHP_TAP": 4,
            "Market_Sector": 5,
            "NAICS_Code": 6,
			"SystemSize": 7,
            "Technology_Prime_Mover": 8,
            "Fuel": 9,
			"Thermal_Energy_Use": 10,
			"YearInstalled": 11,
			"State": 15,
        };

		$.get('chpdb_master_2022_01_05.csv', function (data) {
			var objJson = Papa.parse(removeTrailingLine(data), { "header": true });
			var csvJson = JSON.stringify(objJson.data, null, 2);

			var wind_table = $('#projects-datatable').DataTable({
				"processing": true,
				"serverSide": false,
				"order": [[2, 'asc']],
				"lengthMenu": [[-1, 10, 25, 50, 100], ["All", 10, 25, 50, 100]],
				"pageLength": 25,
				"data": eval(csvJson),

				"columns": [
					{
						"class": 'details-control',
						"orderable": false,
						"data": null,
						"defaultContent": ''
					},
					{ "data": "ProjectID" },
					{
						"data": null, render: function (data, type, row) {
							return '<a href="' + data.Profile + '">' + data.Project + '</a>';
						}
					},
					{
						"data": null, render: function (data, type, row) {
							return '<nobr>'+ data.City + ', ' + data.State+ '</nobr>';
						}
					},
					{ "data": "CHP_TAP" },
					{ "data": "Market_Sector" },
					{ "data": "NAICS_Code" },
					{ "data": "SystemSize" },
					{ "data": "Technology_Prime_Mover" },
					{ "data": "Fuel" },
					{ "data": "Thermal_Energy_Use" },
					{ "data": "YearInstalled" },
					{ "data": "Profile" },
					{ "data": "Status" },
					{ "data": "Comment" },
					{ "data": "State" },
				],
				"columnDefs": [
					{
						"targets": [0],
						"visible": false
					},
					{
						"targets": [1],
						"title": "ProjectId",
						"visible": false
					},
					{
						"targets": [2],
						"title": "Project Name",
					},
					{
						"targets": [3],
						"title": "Location"
					},
					{
						"targets": [4],
						"title": "<nobr>CHP TAP</nobr>",
					},
					{
						"targets": [5],
						"title": "<nobr>Market Sector</nobr>"
					},
					{
						"targets": [6],
						"title": "NAICS Code"
					},
					{
						"targets": [7],
						"title": "System Size"
					},
					{
						"targets": [8],
						"title": "Technology/Prime Mover"
					},
					{
						"targets": [9],
						"title": "Fuel"
					},
					{
						"targets": [10],
						"title": "Thermal Energy Use"
					},
					{
						"targets": [11],
						"title": "Year Installed"
					},
					{
						"targets": [12],
						"title": "Project Profile",
						"visible": false
					},
					{
						"targets": [13],
						"title": "Status",
						"visible": false
					},
					{
						"targets": [14],
						"title": "Comments",
						"visible": false
					},
					{
						"targets": [15],
						"title": "State",
						"visible": false
					},
				],
				"createdRow": function (row, data, index) {
					//$('td', row).eq(0).append(format(data));
				},
				"initComplete": function (settings, json) {

					//commented to allow multiselect code to bind to select				
					// setup_select_filter('chptap_select', '#chptap_div', objColumn['CHP_TAP'], false);
					// setup_select_filter('market_select', '#market_div', objColumn['Market_Sector'], false);
					// setup_select_filter('NAICS_select', '#NAICS_div', objColumn['NAICS_Code'], false);
					// setup_select_filter('tech_select', '#tech_div', objColumn['Technology_Prime_Mover'], false);
					// setup_select_filter('fuel_select', '#fuel_div', objColumn['Fuel'], false);
					// setup_select_filter('thermal_select', '#thermal_div', objColumn['Thermal_Energy_Use'], false);

					$('#projects-datatable_length').find('select').addClass('form-control');
					$('#projects-datatable_filter').find('input').addClass('form-control');
					$('#projects-datatable_paginate').removeClass();
					$('#projects-datatable_paginate').addClass('pagination');

					$('#projects-datatable_info').insertAfter('#projects-datatable_filter');
					
					$('#projects-datatable_filter').find('input').keyup(function () {
						var searchTerm = $('#projects-datatable_filter').find('input').val();
						$('#projects-datatable').DataTable().search('^' + searchTerm + '$');
					});
					// Add event listener for opening and closing details
					$('#projects-datatable tbody').on('click', 'td.details-control', function () {
						var tr = $(this).closest('tr');
						var row = $('#projects-datatable').DataTable().row(tr);

						if (row.child.isShown()) {
							// This row is already open - close it
							row.child.hide();
							tr.removeClass('shown');
						}
						else {
							// Open this row
							row.child(format(row.data())).show();
							tr.addClass('shown');
						}
					});
				}
			});

				function updateDataTable() {
				
					$('#projects-datatable').DataTable().search('').columns().search('').draw();
					
					if ($('#state_div :checked').length != 0) filter_dt_column($('#projects-datatable').DataTable(), objColumn['State'], '#state_div');
					if ($('#chptap_div :checked').length != 0 ) filter_dt_column($('#projects-datatable').DataTable(), objColumn['CHP_TAP'], '#chptap_div');
					if ($('#market_div :checked').length != 0 ) filter_dt_column($('#projects-datatable').DataTable(), objColumn['Market_Sector'], '#market_div');
					if ($('#NAICS_div :checked').length != 0 ) filter_dt_column($('#projects-datatable').DataTable(), objColumn['NAICS_Code'], '#NAICS_div');
					if ($('#tech_div :checked').length != 0) filter_dt_column($('#projects-datatable').DataTable(), objColumn['Technology_Prime_Mover'], '#tech_div');
					if ($('#fuel_div :checked').length != 0 ) filter_dt_column($('#projects-datatable').DataTable(), objColumn['Fuel'], '#fuel_div');
					if ($('#thermal_div :checked').length != 0 ) filter_dt_column($('#projects-datatable').DataTable(), objColumn['Thermal_Energy_Use'], '#thermal_div');
				}
				
				$.fn.dataTable.ext.search.push(
					function( settings, data, dataIndex ) {
						var min = parseInt( $('#sysmin_select').val(), 10 );
						var max = parseInt( $('#sysmax_select').val(), 10 );
						var val = parseInt( data[objColumn["SystemSize"]], 10 ) || 0; 
				 
						if ( ( isNaN( min ) && isNaN( max ) ) ||
							 ( isNaN( min ) && val <= max ) ||
							 ( min <= val   && isNaN( max ) ) ||
							 ( min <= val   && val <= max ) )
						{
							return true;
						}
						return false;
					}
				);
				$.fn.dataTable.ext.search.push(
					function( settings, data, dataIndex ) {
						var min = parseInt( $('#yearmin_select').val(), 10 );
						var max = parseInt( $('#yearmax_select').val(), 10 );
						var val = parseInt( data[objColumn["YearInstalled"]], 10 ) || 0; 
				 
						if ( ( isNaN( min ) && isNaN( max ) ) ||
							 ( isNaN( min ) && val <= max ) ||
							 ( min <= val   && isNaN( max ) ) ||
							 ( min <= val   && val <= max ) )
						{
							return true;
						}
						return false;
					}
				);
				
				$('#sysmin_select, #sysmax_select, #yearmin_select, #yearmax_select').change( function() {
					$('#projects-datatable').DataTable().draw();
				});

				function search_dt_column(dtable, col, cntl) {
					var val = $(cntl).val();
					dtable.column(col).search(val, false, true, true).draw();
				}

				function filter_dt_column(dtable, col, control) {
					var aryCheckVals = [];
					$(control + ' input:checked').each(function () {
						var value = $(this).val();
						//console.log(value);
						aryCheckVals.push(value);
					});
					var strSelectedVals = aryCheckVals.join('|');
					strSelectedVals = strSelectedVals.replace(/\./g, "\\.");
					//console.log(strSelectedVals);

					dtable.column(col)
							.search(strSelectedVals, true, false, false)
							.draw();
				}

                function resetMap () {
                    $("#projects-datatable_filter").find('input').val('');
					
					$('#multiSelectGroup select option:selected').prop('selected', false);
					$("#chptap_select, #market_select, #state_select, #NAICS_select, #tech_select, #fuel_select, #thermal_select").multiselect("refresh");
					
					$('#sysmin_div option:first, #yearmin_div option:first').prop('selected', true);
					$('#sysmax_div option:last, #yearmax_div option:last').prop('selected', true);

                    $('#projects-datatable').DataTable().search('').columns().search('').draw();
                }

                $("#btnReset").click(resetMap);
				
                $('#multiSelectGroup #chptap_select').multiselect({ 
					nonSelectedText: 'Select CHP TAPs', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						//console.log('Changed option ' + $(option).val() + '.');
						updateDataTable();
					}
				});				
				$('#multiSelectGroup #market_select').multiselect({
					nonSelectedText: 'Select Market Sector', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						updateDataTable();
					}
				});
				$('#multiSelectGroup #state_select').multiselect({
					nonSelectedText: 'Select State', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					//buttonText: function(options, select) {
						//if (options.length === 0) {
							//return 'Select State';
						//}
					//},
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						updateDataTable();
					}
				});
				$('#multiSelectGroup #NAICS_select').multiselect({
					nonSelectedText: 'Select NAICS Code', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						updateDataTable();
					}
				});
				
				$('#multiSelectGroup #tech_select').multiselect({
					nonSelectedText: 'Select Technology/Prime Mover', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						updateDataTable();
					}
				});

				$('#multiSelectGroup #fuel_select').multiselect({
					nonSelectedText: 'Select Fuel', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						updateDataTable();
					}
				});

				$('#multiSelectGroup #thermal_select').multiselect({
					nonSelectedText: 'Select Thermal Energy Use', 
					enableClickableOptGroups: true,
					includeSelectAllOption: false,
					buttonWidth: '100%',
					numberDisplayed: 0,
					onChange: function(option, checked, select) {
						updateDataTable();
					}
				});
				
				$('select').addClass('form-control');
				$('#chptap_select, #market_select, #state_select, #NAICS_select, #tech_select, #fuel_select, #thermal_select').addClass('form-control').hide();

				//resetMap();
				updateDataTable();

			});
		});

        function setup_select_filter(strSelectID, strDivID, intCol, blnMulti) {

            var tmpMarkup, tmpLabel, chkBoxMarkup;

            if (!blnMulti) {
                selectMarkup = $('<select id="' + strSelectID + '"></select>').appendTo($(strDivID));
                $('<option value="All">All</option>').appendTo(selectMarkup);

                $('#projects-datatable').DataTable().column(intCol).data().unique().sort().each(function (data, value) {

                    var itemValue;
                    itemValue = data.trim();

                    if (itemValue == '') return;

                    itemMarkup = $('<option />');
                    itemMarkup.val(itemValue);

                    var newLabel = itemValue;
                    itemMarkup.append(newLabel);
                    var options = $('#' + strSelectID + ' option');
                    var values = $.map(options, function (option) {
                        return option.value;
                    });

                    var flag = false;
                    for (var i = 0; i < values.length; i++) {
                        if (itemValue == values[i].trim())
                            flag = true;
                    }
                    if (flag == false)
                        itemMarkup.appendTo(selectMarkup);
                });
            }
            else {
                //there are multiple values in the column. Separate and find all uniques
                var aryAllValues = [], objAllValues = {};
                $('#projects-datatable').DataTable().column(intCol).data().each(function (d, j) {
                    var tmpColumnValue = d, tmpAryValues = [];
                    if (typeof tmpColumnValue === 'object') {
                        if (objColumn['Program_Area'] == intCol)
                            tmpColumnValue = d.Program_Area.toString();
                    }

                    if (tmpColumnValue.indexOf("; ") > 0) {
                        tmpAryValues = tmpColumnValue.split("; ");
                        $.each(tmpAryValues, function (key, val) {
                            objAllValues[val.trim()] = true;
                        });

                    }
                    else {
                        objAllValues[tmpColumnValue.trim()] = true;
                    }
                });
                for (var k in objAllValues) { if (k != '') { aryAllValues.push(k); } }
                aryAllValues.sort();

                //Build facet control depending on unique values from the column
                selectMarkup = $('<select/>').attr('id', strSelectID).appendTo($(strDivID));
                $('<option/>').attr('value', 'All').text('All').appendTo(selectMarkup);

                $.each(aryAllValues, function (key, val) {
                    itemMarkup = $('<option/>');
                    itemMarkup.val(val.trim());
                    itemMarkup.append(val.trim());

                    var options = $('#' + strSelectID + ' span');
                    var values = $.map(options, function (option) {
                        return option.value;
                    });

                    var flag = false;
                    for (var i = 0; i < values.length; i++) {
                        if (val.trim() == values[i])
                            flag = true;
                    }
                    if (flag == false)
                        itemMarkup.appendTo(selectMarkup);
                });

            }
        }

</script>
